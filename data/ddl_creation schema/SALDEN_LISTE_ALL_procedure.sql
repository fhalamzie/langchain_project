-- Prozedur: SALDEN_LISTE_ALL
-- Generiert: 2025-05-31 10:26:42

CREATE OR ALTER PROCEDURE SALDEN_LISTE_ALL
DECLARE VARIABLE GN SMALLINT;
DECLARE VARIABLE RTMP1 NUMERIC(18, 2);
DECLARE VARIABLE RTMP2 NUMERIC(18, 2);
DECLARE VARIABLE IKVON INTEGER;
DECLARE VARIABLE IKBIS INTEGER;
DECLARE VARIABLE ITMP1 INTEGER;
DECLARE VARIABLE ITMP2 INTEGER;
DECLARE VARIABLE IART1 INTEGER;
DECLARE VARIABLE IART2 INTEGER;
DECLARE VARIABLE IART3 INTEGER;
DECLARE VARIABLE IART4 INTEGER;
DECLARE VARIABLE ITMPKLASSE INTEGER;
DECLARE VARIABLE ITMPKNR INTEGER;
DECLARE VARIABLE RTVORTRAG NUMERIC(18, 2);
DECLARE VARIABLE RTGSOLL1 NUMERIC(18, 2);
/* Miete, Hausgeld */
DECLARE VARIABLE RTGBEZ1 NUMERIC(18, 2);
/* Miete, Hausgeld */
DECLARE VARIABLE RTGBEZNETTO1 NUMERIC(18, 2);
/* Miete, Hausgeld */
DECLARE VARIABLE RTGSOLL2 NUMERIC(18, 2);
/* BK, RÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Â ÃƒÂ¢Ã¢â€šÂ¬Ã¢â€žÂ¢ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â¼cklagen */
DECLARE VARIABLE RTGBEZ2 NUMERIC(18, 2);
/* BK, RÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Â ÃƒÂ¢Ã¢â€šÂ¬Ã¢â€žÂ¢ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â¼cklagen */
DECLARE VARIABLE RTGBEZNETTO2 NUMERIC(18, 2);
/* BK, RÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Â ÃƒÂ¢Ã¢â€šÂ¬Ã¢â€žÂ¢ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â¼cklagen */
DECLARE VARIABLE RTGSOLL3 NUMERIC(18, 2);
/* HK, Sonderumlage */
DECLARE VARIABLE RTGBEZ3 NUMERIC(18, 2);
/* HK, Sonderumlage */
DECLARE VARIABLE RTGBEZNETTO3 NUMERIC(18, 2);
/* HK, Sonderumlage */
DECLARE VARIABLE RTGSOLL4 NUMERIC(18, 2);
/* GN, GN */
DECLARE VARIABLE RTGBEZ4 NUMERIC(18, 2);
/* GN, GN */
DECLARE VARIABLE RTGBEZNETTO4 NUMERIC(18, 2);
/* GN, GN */
DECLARE VARIABLE RSUMVORTRAG NUMERIC(18, 2);
DECLARE VARIABLE RSUMGSOLL1 NUMERIC(18, 2);
/* Miete, Hausgeld */
DECLARE VARIABLE RSUMGBEZ1 NUMERIC(18, 2);
/* Miete, Hausgeld */
DECLARE VARIABLE RSUMGBEZNETTO1 NUMERIC(18, 2);
/* Miete, Hausgeld */
DECLARE VARIABLE RSUMGSOLL2 NUMERIC(18, 2);
/* BK, RÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Â ÃƒÂ¢Ã¢â€šÂ¬Ã¢â€žÂ¢ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â¼cklagen */
DECLARE VARIABLE RSUMGBEZ2 NUMERIC(18, 2);
/* BK, RÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Â ÃƒÂ¢Ã¢â€šÂ¬Ã¢â€žÂ¢ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â¼cklagen */
DECLARE VARIABLE RSUMGBEZNETTO2 NUMERIC(18, 2);
/* BK, RÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Â ÃƒÂ¢Ã¢â€šÂ¬Ã¢â€žÂ¢ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â¼cklagen */
DECLARE VARIABLE RSUMGSOLL3 NUMERIC(18, 2);
/* HK, Sonderumlage */
DECLARE VARIABLE RSUMGBEZ3 NUMERIC(18, 2);
/* HK, Sonderumlage */
DECLARE VARIABLE RSUMGBEZNETTO3 NUMERIC(18, 2);
/* HK, Sonderumlage */
DECLARE VARIABLE RSUMGSOLL4 NUMERIC(18, 2);
/* GN, GN */
DECLARE VARIABLE RSUMGBEZ4 NUMERIC(18, 2);
/* GN, GN */
DECLARE VARIABLE RSUMGBEZNETTO4 NUMERIC(18, 2);
/* GN, GN */
DECLARE VARIABLE DTVONBDATUM DATE;
DECLARE VARIABLE DTBISBDATUM DATE;
DECLARE VARIABLE DTVONWDATUM DATE;
DECLARE VARIABLE DTBISWDATUM DATE;
DECLARE VARIABLE SNAME CHAR(88);
DECLARE VARIABLE SVZ1BEZ VARCHAR(88);
DECLARE VARIABLE RVZ1SUMSOLL NUMERIC(18, 2);
DECLARE VARIABLE RVZ1SUMBEZ NUMERIC(18, 2);
DECLARE VARIABLE RVZ1SUMBEZNETTO NUMERIC(18, 2);
DECLARE VARIABLE SVZ2BEZ VARCHAR(88);
DECLARE VARIABLE RVZ2SUMSOLL NUMERIC(18, 2);
DECLARE VARIABLE RVZ2SUMBEZ NUMERIC(18, 2);
DECLARE VARIABLE RVZ2SUMBEZNETTO NUMERIC(18, 2);
DECLARE VARIABLE SVZ3BEZ VARCHAR(88);
DECLARE VARIABLE RVZ3SUMSOLL NUMERIC(18, 2);
DECLARE VARIABLE RVZ3SUMBEZ NUMERIC(18, 2);
DECLARE VARIABLE RVZ3SUMBEZNETTO NUMERIC(18, 2);
DECLARE VARIABLE SVZ4BEZ VARCHAR(88);
DECLARE VARIABLE RVZ4SUMSOLL NUMERIC(18, 2);
DECLARE VARIABLE RVZ4SUMBEZ NUMERIC(18, 2);
DECLARE VARIABLE RVZ4SUMBEZNETTO NUMERIC(18, 2);
DECLARE VARIABLE SVZ5BEZ VARCHAR(88);
DECLARE VARIABLE RVZ5SUMSOLL NUMERIC(18, 2);
DECLARE VARIABLE RVZ5SUMBEZ NUMERIC(18, 2);
DECLARE VARIABLE RVZ5SUMBEZNETTO NUMERIC(18, 2);
DECLARE VARIABLE SVZ6BEZ VARCHAR(88);
DECLARE VARIABLE RVZ6SUMSOLL NUMERIC(18, 2);
DECLARE VARIABLE RVZ6SUMBEZ NUMERIC(18, 2);
DECLARE VARIABLE RVZ6SUMBEZNETTO NUMERIC(18, 2);
DECLARE VARIABLE SVZ7BEZ VARCHAR(88);
DECLARE VARIABLE RVZ7SUMSOLL NUMERIC(18, 2);
DECLARE VARIABLE RVZ7SUMBEZ NUMERIC(18, 2);
DECLARE VARIABLE RVZ7SUMBEZNETTO NUMERIC(18, 2);
DECLARE VARIABLE SVZ8BEZ VARCHAR(88);
DECLARE VARIABLE RVZ8SUMSOLL NUMERIC(18, 2);
DECLARE VARIABLE RVZ8SUMBEZ NUMERIC(18, 2);
DECLARE VARIABLE RVZ8SUMBEZNETTO NUMERIC(18, 2);
DECLARE VARIABLE SVZ9BEZ VARCHAR(88);
DECLARE VARIABLE RVZ9SUMSOLL NUMERIC(18, 2);
DECLARE VARIABLE RVZ9SUMBEZ NUMERIC(18, 2);
DECLARE VARIABLE RVZ9SUMBEZNETTO NUMERIC(18, 2);
DECLARE VARIABLE SVZ10BEZ VARCHAR(88);
DECLARE VARIABLE RVZ10SUMSOLL NUMERIC(18, 2);
DECLARE VARIABLE RVZ10SUMBEZ NUMERIC(18, 2);
DECLARE VARIABLE RVZ10SUMBEZNETTO NUMERIC(18, 2);
DECLARE VARIABLE RGNPOSSOLL NUMERIC(18, 2);
DECLARE VARIABLE RGNPOS NUMERIC(18, 2);
DECLARE VARIABLE RGNPOSNETTO NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_VZ1 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_VZ1 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_VZ1 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_VZ2 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_VZ2 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_VZ2 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_VZ3 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_VZ3 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_VZ3 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_VZ4 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_VZ4 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_VZ4 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_VZ5 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_VZ5 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_VZ5 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_VZ6 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_VZ6 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_VZ6 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_VZ7 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_VZ7 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_VZ7 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_VZ8 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_VZ8 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_VZ8 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_SUMVZ1 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_SUMVZ1 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_SUMVZ1 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_SUMVZ2 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_SUMVZ2 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_SUMVZ2 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_SUMVZ3 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_SUMVZ3 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_SUMVZ3 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_SUMVZ4 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_SUMVZ4 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_SUMVZ4 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_SUMVZ5 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_SUMVZ5 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_SUMVZ5 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_SUMVZ6 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_SUMVZ6 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_SUMVZ6 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_SUMVZ7 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_SUMVZ7 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_SUMVZ7 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGSOLL_SUMVZ8 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIG_SUMVZ8 NUMERIC(18, 2);
DECLARE VARIABLE RGNEIGNETTO_SUMVZ8 NUMERIC(18, 2);
BEGIN
 /* Konten selektieren */
 if (:BBEW = 'J') then
  BEGIN
   IKVON = 100000;
   IKBIS = 199999;
   IART1 = 10;
   IART2 = 11;
   IART3 = 12;
   IART4 = 13; 
  END
 else
  BEGIN
   IKVON = 200000;
   IKBIS = 299999;
   IART1 = 15;
   IART2 = 16;
   IART3 = 17;
   IART4 = 18;
  END
 /* W_Datum abfragen */
 if (WDATUM = 'N') then
  begin
   DTVONBDATUM = DTVON;
   DTBISBDATUM = DTBIS;
   DTVONWDATUM = '01.01.1900';
   DTBISWDATUM = '01.01.1900';
  end
 else
  begin
   DTVONBDATUM = '01.01.1900';
   DTBISBDATUM = '01.01.1900';
   DTVONWDATUM = DTVON;
   DTBISWDATUM = DTBIS;
  end
 RSUMVORTRAG = 0;
 RSUMGSOLL1 = 0; RSUMGBEZ1 = 0; RSUMGBEZNETTO1 = 0;
 RSUMGSOLL2 = 0; RSUMGBEZ2 = 0; RSUMGBEZNETTO2 = 0;
 RSUMGSOLL3 = 0; RSUMGBEZ3 = 0; RSUMGBEZNETTO3 = 0;
 RSUMGSOLL4 = 0; RSUMGBEZ4 = 0; RSUMGBEZNETTO4 = 0;
 SVZ1BEZ = ''; RVZ1SUMSOLL = 0; RVZ1SUMBEZ = 0; RVZ1SUMBEZNETTO = 0;
 SVZ2BEZ = ''; RVZ2SUMSOLL = 0; RVZ2SUMBEZ = 0; RVZ2SUMBEZNETTO = 0;
 SVZ3BEZ = ''; RVZ3SUMSOLL = 0; RVZ3SUMBEZ = 0; RVZ3SUMBEZNETTO = 0;
 SVZ4BEZ = ''; RVZ4SUMSOLL = 0; RVZ4SUMBEZ = 0; RVZ4SUMBEZNETTO = 0;
 SVZ5BEZ = ''; RVZ5SUMSOLL = 0; RVZ5SUMBEZ = 0; RVZ5SUMBEZNETTO = 0;
 SVZ6BEZ = ''; RVZ6SUMSOLL = 0; RVZ6SUMBEZ = 0; RVZ6SUMBEZNETTO = 0;
 SVZ7BEZ = ''; RVZ7SUMSOLL = 0; RVZ7SUMBEZ = 0; RVZ7SUMBEZNETTO = 0;
 SVZ8BEZ = ''; RVZ8SUMSOLL = 0; RVZ8SUMBEZ = 0; RVZ8SUMBEZNETTO = 0;
 SVZ9BEZ = ''; RVZ9SUMSOLL = 0; RVZ9SUMBEZ = 0; RVZ9SUMBEZNETTO = 0;
 SVZ10BEZ = ''; RVZ10SUMSOLL = 0; RVZ10SUMBEZ = 0; RVZ10SUMBEZNETTO = 0;
 RGNEIG_SUMVZ1 = 0; RGNEIGNETTO_SUMVZ1 = 0; RGNEIGSOLL_SUMVZ1 = 0;
 RGNEIG_SUMVZ2 = 0; RGNEIGNETTO_SUMVZ2 = 0; RGNEIGSOLL_SUMVZ2 = 0; 
 RGNEIG_SUMVZ3 = 0; RGNEIGNETTO_SUMVZ3 = 0; RGNEIGSOLL_SUMVZ3 = 0; 
 RGNEIG_SUMVZ4 = 0; RGNEIGNETTO_SUMVZ4 = 0; RGNEIGSOLL_SUMVZ4 = 0; 
 RGNEIG_SUMVZ5 = 0; RGNEIGNETTO_SUMVZ5 = 0; RGNEIGSOLL_SUMVZ5 = 0; 
 RGNEIG_SUMVZ6 = 0; RGNEIGNETTO_SUMVZ6 = 0; RGNEIGSOLL_SUMVZ6 = 0; 
 RGNEIG_SUMVZ7 = 0; RGNEIGNETTO_SUMVZ7 = 0; RGNEIGSOLL_SUMVZ7 = 0; 
 RGNEIG_SUMVZ8 = 0; RGNEIGNETTO_SUMVZ8 = 0; RGNEIGSOLL_SUMVZ8 = 0;  
 /* Auswertung */
 FOR SELECT konten.onr, konten.knr, konten.knrstr, konten.kbez from konten, objekte
  WHERE konten.knr >= :IKVON and konten.knr <= :IKBIS and konten.onr=objekte.onr and ((knr<200000 and bsonst<>1) or (knr>199999 and bsonst<>0)) order by konten.onr, knr
  INTO :IONR, :KNR, :KNRSTR, :SNAME
 DO
  BEGIN
   RTVORTRAG = 0;
   RTGSOLL1 = 0; RTGBEZ1 = 0; RTGBEZNETTO1 = 0;
   RTGSOLL2 = 0; RTGBEZ2 = 0; RTGBEZNETTO2 = 0;
   RTGSOLL3 = 0; RTGBEZ3 = 0; RTGBEZNETTO3 = 0;
   RTGSOLL4 = 0; RTGBEZ4 = 0; RTGBEZNETTO4 = 0;
   RVORTRAG = 0;
   RGSOLL1 = 0; RGBEZ1 = 0; RGBEZNETTO1 = 0;
   RGSOLL2 = 0; RGBEZ2 = 0; RGBEZNETTO2 = 0;
   RGSOLL3 = 0; RGBEZ3 = 0; RGBEZNETTO3 = 0;
   RGSOLL4 = 0; RGBEZ4 = 0; RGBEZNETTO4 = 0; 
   RGNEIG = 0; RGNEIGNETTO = 0; RGNEIGSOLL = 0;
   RGNEIG_VZ1 = 0; RGNEIGNETTO_VZ1 = 0; RGNEIGSOLL_VZ1 = 0;  
   RGNEIG_VZ2 = 0; RGNEIGNETTO_VZ2 = 0; RGNEIGSOLL_VZ2 = 0;  
   RGNEIG_VZ3 = 0; RGNEIGNETTO_VZ3 = 0; RGNEIGSOLL_VZ3 = 0; 
   RGNEIG_VZ4 = 0; RGNEIGNETTO_VZ4 = 0; RGNEIGSOLL_VZ4 = 0; 
   RGNEIG_VZ5 = 0; RGNEIGNETTO_VZ5 = 0; RGNEIGSOLL_VZ5 = 0; 
   RGNEIG_VZ6 = 0; RGNEIGNETTO_VZ6 = 0; RGNEIGSOLL_VZ6 = 0; 
   RGNEIG_VZ7 = 0; RGNEIGNETTO_VZ7 = 0; RGNEIGSOLL_VZ7 = 0; 
   RGNEIG_VZ8 = 0; RGNEIGNETTO_VZ8 = 0; RGNEIGSOLL_VZ8 = 0;     
   GESCHOSS = NULL;
   MIETEINNAHME_ART = NULL;
   /* Vortrag Sollstellungen */
   select SUM(BETRAG) from buchung
    where ONRSOLL = :IONR and KSOLL = :KNR and ((Datum < :DTVONBDATUM) or (WDatum < :DTVONWDATUM)) and OPNR IS NOT NULL AND OPBETRAG IS NOT NULL
    into :RTVORTRAG;
   IF (RTVORTRAG IS NULL) THEN
    RTVORTRAG = 0;
   /* Vortrag Zahlung im Konto (H) */
   SELECT SUM(BETRAG) from buchung
    where ONRHABEN = :IONR and KHABEN = :KNR and (ARTOP IS NOT NULL) and ((Datum < :DTVONBDATUM) or (WDatum < :DTVONWDATUM))
    INTO :RTMP1;
   IF (RTMP1 IS NULL) THEN
    RTMP1 = 0;
   RTMP2=RTMP1;
   /* Vortrag Zahlung im Konto (S) */
   SELECT SUM(BETRAG) from buchung
   where ONRSOLL = :IONR and KSOLL = :KNR and (ARTOP IS NOT NULL) and ((Datum < :DTVONBDATUM) or (WDatum < :DTVONWDATUM))
   INTO :RTMP1;
   IF (RTMP1 IS NULL) THEN
    RTMP1 = 0;
   RTVORTRAG = RTMP2 - RTMP1 - RTVORTRAG;
   RTMP2 = 0;
   RTMP1 = 0;
   for select KNR,KBEZ,KKLASSE from konten where ONR = :IONR and ((KKLASSE = :IART1) or (KKLASSE = :IART2) or (KKLASSE = :IART3) or (KKLASSE = :IART4) or (KKLASSE >= 110)) and KNR <> 60190
    order by 1
   into :ITMPKNR, :SKBEZ, :ITMPKLASSE
   do
    begin
     ITMP1 = 0;
     ITMP2 = 0;
     RTMP1 = 0;
     RTMP2 = 0;
     RPOSSOLL = 0;
     RPOSBEZ = 0;
     RPOSBEZNETTO = 0;
     RGNPOS = 0;
     RGNPOSNETTO = 0;
     RGNPOSSOLL = 0;
     /*                */
     /* SOLLSTELLUNGEN */
     /*                */
     for select SUM(BETRAG), ARTHABEN, GN from buchung
      where ONRSOLL = :IONR and KSOLL = :KNR and KHABEN = :ITMPKNR and ((Datum >= :DTVONBDATUM and Datum <= :DTBISBDATUM) or (WDatum >= :DTVONWDATUM and WDatum <= :DTBISWDATUM)) and OPNR IS NOT NULL AND OPBETRAG IS NOT NULL
      group by KHABEN, ARTHABEN, GN
      into :RTMP1, :ITMP2, :GN
     do
      begin
       IF (RTMP1 IS NULL) THEN
        RTMP1 = 0;
       RPOSSOLL = RPOSSOLL + RTMP1;
       /*  */
       if (GN = 1) then
        begin
         ITMP2 = IART4;
         RGNPOSSOLL = RGNPOSSOLL + RTMP1;
        end
       IF (ITMP2 = IART1) THEN
        BEGIN
         RTGSOLL1 = RTGSOLL1 + RTMP1;
        END
       ELSE
        IF ((ITMP2 = IART2) or (ITMP2 >= 110 and ITMP2 <= 170)) THEN
         BEGIN
          RTGSOLL2 = RTGSOLL2 + RTMP1;
         END
        ELSE
         IF (ITMP2 = IART3) THEN
          BEGIN
           RTGSOLL3 = RTGSOLL3 + RTMP1;
          END
         ELSE
          IF (ITMP2 = IART4) THEN
           BEGIN
            RTGSOLL4 = RTGSOLL4 + RTMP1;
           END
       RTMP1 = 0;
       ITMP2 = 0;
      end
     /*           */
     /* ZAHLUNGEN */
     /*           */
     /* Zahlung im HABEN KEIN SPLIT */
     for select SUM(BETRAG), SUM((BETRAG*100) / (100+MWSTOP)), ARTOP, GN from buchung
      where ONRHABEN = :IONR and KNROP = :ITMPKNR and KHABEN = :KNR and ((Datum >= :DTVONBDATUM and Datum <= :DTBISBDATUM) or (WDatum >= :DTVONWDATUM and WDatum <= :DTBISWDATUM)) AND (ARTOP <> 0)
      group by ARTOP, GN
     INTO :RTMP1, :RTMP2, :ITMP2, :GN
     do
      begin
       if (RTMP1 IS NULL) then
        RTMP1 = 0;
       if (RTMP2 IS NULL) then
        RTMP2 = 0;
       RPOSBEZ = RPOSBEZ + RTMP1;
       RPOSBEZNETTO = RPOSBEZNETTO + RTMP2;
       /*  */
       if (GN = 1) then
        begin
         ITMP2 = IART4;
         RGNPOS = RGNPOS + RTMP1;
         RGNPOSNETTO = RGNPOSNETTO + RTMP2;
        end
       IF (ITMP2 = IART1) THEN
        BEGIN
         RTGBEZ1 = RTGBEZ1 + RTMP1;
         RTGBEZNETTO1 = RTGBEZNETTO1 + RTMP2;
        END
       ELSE
        IF ((ITMP2 = IART2) or (ITMP2 >= 110 and ITMP2 <= 170)) THEN
         BEGIN
          RTGBEZ2 = RTGBEZ2 + RTMP1;
          RTGBEZNETTO2 = RTGBEZNETTO2 + RTMP2;
         END
        ELSE
         IF (ITMP2 = IART3) THEN
          BEGIN
           RTGBEZ3 = RTGBEZ3 + RTMP1;
           RTGBEZNETTO3 = RTGBEZNETTO3 + RTMP2;
          END
         ELSE
          IF (ITMP2 = IART4) THEN
           BEGIN
            RTGBEZ4 = RTGBEZ4 + RTMP1;
            RTGBEZNETTO4 = RTGBEZNETTO4 + RTMP2;
           END
       RTMP1 = 0;
       RTMP2 = 0;
       ITMP2 = 0;
       GN = 0;
      end
     /* ZAHLUNG im SOLL KEIN SPLIT */
     for SELECT SUM(BETRAG), SUM((BETRAG*100) / (100+MWSTOP)), ARTOP, GN from buchung
      where ONRSOLL=:IONR and KNROP = :ITMPKNR and KSOLL=:KNR and ((Datum >= :DTVONBDATUM and Datum <= :DTBISBDATUM) or (WDatum >= :DTVONWDATUM and WDatum <= :DTBISWDATUM)) AND (ARTOP<>0)
      group by ARTOP, GN
     INTO :RTMP1, :RTMP2, :ITMP2, :GN
     do
      begin
       if (RTMP1 IS NULL) then
        RTMP1 = 0;
       if (RTMP2 IS NULL) then
        RTMP2 = 0;
       RPOSBEZ = RPOSBEZ - RTMP1;
       RPOSBEZNETTO = RPOSBEZNETTO - RTMP2;
       /*  */
       if (GN = 1) then
        begin
         ITMP2 = IART4;
         RGNPOS = RGNPOS - RTMP1;
         RGNPOSNETTO = RGNPOSNETTO - RTMP2;
        end
       IF (ITMP2 = IART1) THEN
        BEGIN
         RTGBEZ1 = RTGBEZ1 - RTMP1;
         RTGBEZNETTO1 = RTGBEZNETTO1 - RTMP2;
        END
       ELSE
        IF ((ITMP2 = IART2) or (ITMP2 >= 110 and ITMP2 <= 170)) THEN
         BEGIN
          RTGBEZ2 = RTGBEZ2 - RTMP1;
          RTGBEZNETTO2 = RTGBEZNETTO2 - RTMP2;
         END
        ELSE
         IF (ITMP2 = IART3) THEN
          BEGIN
           RTGBEZ3 = RTGBEZ3 - RTMP1;
           RTGBEZNETTO3 = RTGBEZNETTO3 - RTMP2;
          END
         ELSE
          IF (ITMP2 = IART4) THEN
           BEGIN
            RTGBEZ4 = RTGBEZ4 - RTMP1;
            RTGBEZNETTO4 = RTGBEZNETTO4 - RTMP2;
           END
       RTMP1 = 0;
       RTMP2 = 0;
       ITMP2 = 0;
       GN = 0;
      end
     /* Zahlung im HABEN split*/
     for select sum(buchzahl.betrag), SUM((buchzahl.BETRAG*100) / (100+buchzahl.MWSTOP)), buchzahl.artop, GN from buchzahl, buchung
      where buchzahl.bnr=buchung.bnr
      and onrhaben=:IONR and buchzahl.knr=:ITMPKNR and khaben=:KNR and buchung.ARTOP=0 and ((Datum >= :DTVONBDATUM and Datum <= :DTBISBDATUM) or (WDatum >= :DTVONWDATUM and WDatum <= :DTBISWDATUM))
      group by buchzahl.artop, GN
     into :RTMP1, :RTMP2, :ITMP2, :GN
     do
      begin
       if (RTMP1 IS NULL) then
        RTMP1 = 0;
       if (RTMP2 IS NULL) then
        RTMP2 = 0;
       RPOSBEZ = RPOSBEZ + RTMP1;
       RPOSBEZNETTO = RPOSBEZNETTO + RTMP2;
       /*  */
       if (GN = 1) then
        begin
         ITMP2 = IART4;
         RGNPOS = RGNPOS + RTMP1;
         RGNPOSNETTO = RGNPOSNETTO + RTMP2;
        end
       IF (ITMP2 = IART1) THEN
        BEGIN
         RTGBEZ1 = RTGBEZ1 + RTMP1;
         RTGBEZNETTO1 = RTGBEZNETTO1 + RTMP2;
        END
       ELSE
        IF ((ITMP2 = IART2) or (ITMP2 >= 110 and ITMP2 <= 170)) THEN
         BEGIN
          RTGBEZ2 = RTGBEZ2 + RTMP1;
          RTGBEZNETTO2 = RTGBEZNETTO2 + RTMP2;
         END
        ELSE
         IF (ITMP2 = IART3) THEN
          BEGIN
           RTGBEZ3 = RTGBEZ3 + RTMP1;
           RTGBEZNETTO3 = RTGBEZNETTO3 + RTMP2;
          END
         ELSE
          IF (ITMP2 = IART4) THEN
           BEGIN
            RTGBEZ4 = RTGBEZ4 + RTMP1;
            RTGBEZNETTO4 = RTGBEZNETTO4 + RTMP2;
           END
      end
     RTMP1 = 0;
     RTMP2 = 0;
     ITMP2 = 0;
     GN = 0;
     /* Zahlung im Soll split */
     for select sum(buchzahl.betrag), SUM((buchzahl.BETRAG*100) / (100+buchzahl.MWSTOP)), buchzahl.artop, GN from buchzahl, buchung
      where buchzahl.bnr=buchung.bnr
      and onrsoll=:IONR and buchzahl.knr=:ITMPKNR and ksoll=:KNR and buchung.ARTOP=0 and ((Datum >= :DTVONBDATUM and Datum <= :DTBISBDATUM) or (WDatum >= :DTVONWDATUM and WDatum <= :DTBISWDATUM))
      group by buchzahl.artop, GN
     into :RTMP1, :RTMP2, :ITMP2, :GN
     do
      begin
       if (RTMP1 IS NULL) then
        RTMP1 = 0;
       if (RTMP2 IS NULL) then
        RTMP2 = 0;
       RPOSBEZ = RPOSBEZ - RTMP1;
       RPOSBEZNETTO = RPOSBEZNETTO - RTMP2;
       /*  */
       if (GN = 1) then
        begin
         ITMP2 = IART4;
         RGNPOS = RGNPOS - RTMP1;
         RGNPOSNETTO = RGNPOSNETTO - RTMP2;
        end
       IF (ITMP2 = IART1) THEN
        BEGIN
         RTGBEZ1 = RTGBEZ1 - RTMP1;
         RTGBEZNETTO1 = RTGBEZNETTO1 - RTMP2;
        END
       ELSE
        IF ((ITMP2 = IART2) or (ITMP2 >= 110 and ITMP2 <= 170)) THEN
         BEGIN
          RTGBEZ2 = RTGBEZ2 - RTMP1;
          RTGBEZNETTO2 = RTGBEZNETTO2 - RTMP2;
         END
        ELSE
         IF (ITMP2 = IART3) THEN
          BEGIN
           RTGBEZ3 = RTGBEZ3 - RTMP1;
           RTGBEZNETTO3 = RTGBEZNETTO3 - RTMP2;
          END
         ELSE
          IF (ITMP2 = IART4) THEN
           BEGIN
            RTGBEZ4 = RTGBEZ4 - RTMP1;
            RTGBEZNETTO4 = RTGBEZNETTO4 - RTMP2;
           END
      end
     /*  */
     BISNULL = 'N';
     ISMASTER = 0;
     VZKNR= ITMPKNR;
     /* Eventuell GN wieder abziehen */
     RPOSSOLL = RPOSSOLL - RGNPOSSOLL;
     RPOSBEZ = RPOSBEZ - RGNPOS;
     RPOSBEZNETTO = RPOSBEZNETTO - RGNPOSNETTO;
     RGNEIG = RGNEIG + RGNPOS;
     RGNEIGNETTO = RGNEIGNETTO + RGNPOSNETTO;
     RGNEIGSOLL = RGNEIGSOLL + RGNPOSSOLL;
     if ((RPOSSOLL <> 0) or (RPOSBEZ <> 0) or (RPOSBEZNETTO <> 0)) then
      begin
       /* VZ1 */
       if ((ITMPKNR = 60000) or (ITMPKNR = 60100)) then
        begin
         SVZ1BEZ = SKBEZ;
         RVZ1SUMSOLL = RVZ1SUMSOLL + RPOSSOLL;
         RVZ1SUMBEZ = RVZ1SUMBEZ + RPOSBEZ;
         RVZ1SUMBEZNETTO = RVZ1SUMBEZNETTO + RPOSBEZNETTO;
        end
       /* VZ2 */
       if ((ITMPKNR = 60010) or (ITMPKNR = 60110)) then
        begin
         SVZ2BEZ = SKBEZ;
         RVZ2SUMSOLL = RVZ2SUMSOLL + RPOSSOLL;
         RVZ2SUMBEZ = RVZ2SUMBEZ + RPOSBEZ;
         RVZ2SUMBEZNETTO = RVZ2SUMBEZNETTO + RPOSBEZNETTO;
        end
       /* VZ3 */
       if ((ITMPKNR = 60020) or (ITMPKNR = 60120)) then
        begin
         SVZ3BEZ = SKBEZ;
         RVZ3SUMSOLL = RVZ3SUMSOLL + RPOSSOLL;
         RVZ3SUMBEZ = RVZ3SUMBEZ + RPOSBEZ;
         RVZ3SUMBEZNETTO = RVZ3SUMBEZNETTO + RPOSBEZNETTO;
        end
       /* VZ4 */
       if ((ITMPKNR = 60030) or (ITMPKNR = 60130)) then
        begin
         SVZ4BEZ = SKBEZ;
         RVZ4SUMSOLL = RVZ4SUMSOLL + RPOSSOLL;
         RVZ4SUMBEZ = RVZ4SUMBEZ + RPOSBEZ;
         RVZ4SUMBEZNETTO = RVZ4SUMBEZNETTO + RPOSBEZNETTO;
        end
       /* VZ5 */
       if ((ITMPKNR = 60040) or (ITMPKNR = 60140)) then
        begin
         SVZ5BEZ = SKBEZ;
         RVZ5SUMSOLL = RVZ5SUMSOLL + RPOSSOLL;
         RVZ5SUMBEZ = RVZ5SUMBEZ + RPOSBEZ;
         RVZ5SUMBEZNETTO = RVZ5SUMBEZNETTO + RPOSBEZNETTO;
        end
       /* VZ6 */
       if ((ITMPKNR = 60050) or (ITMPKNR = 60150)) then
        begin
         SVZ6BEZ = SKBEZ;
         RVZ6SUMSOLL = RVZ6SUMSOLL + RPOSSOLL;
         RVZ6SUMBEZ = RVZ6SUMBEZ + RPOSBEZ;
         RVZ6SUMBEZNETTO = RVZ6SUMBEZNETTO + RPOSBEZNETTO;
        end
       /* VZ7 */
       if ((ITMPKNR = 60060) or (ITMPKNR = 60160)) then
        begin
         SVZ7BEZ = SKBEZ;
         RVZ7SUMSOLL = RVZ7SUMSOLL + RPOSSOLL;
         RVZ7SUMBEZ = RVZ7SUMBEZ + RPOSBEZ;
         RVZ7SUMBEZNETTO = RVZ7SUMBEZNETTO + RPOSBEZNETTO;
        end
       /* VZ8 */
       if ((ITMPKNR = 60070) or (ITMPKNR = 60170)) then
        begin
         SVZ8BEZ = SKBEZ;
         RVZ8SUMSOLL = RVZ8SUMSOLL + RPOSSOLL;
         RVZ8SUMBEZ = RVZ8SUMBEZ + RPOSBEZ;
         RVZ8SUMBEZNETTO = RVZ8SUMBEZNETTO + RPOSBEZNETTO;
        end
       /* VZ Sonderumlage */
       if (ITMPKNR = 60180) then
        begin
         SVZ9BEZ = SKBEZ;
         RVZ9SUMSOLL = RVZ9SUMSOLL + RPOSSOLL;
         RVZ9SUMBEZ = RVZ9SUMBEZ + RPOSBEZ;
         RVZ9SUMBEZNETTO = RVZ9SUMBEZNETTO + RPOSBEZNETTO;
        end
       /* Guthaben/Nachzahlungen */
       if ((ITMPKNR = 60090)) then
        begin
         SVZ10BEZ = 'Guthaben/Nachzahlungen';
         if (ITMPKNR = 60090) then
          begin
           RVZ10SUMSOLL = RVZ10SUMSOLL + RPOSSOLL;
           RVZ10SUMBEZ = RVZ10SUMBEZ + RPOSBEZ;
           RVZ10SUMBEZNETTO = RVZ10SUMBEZNETTO + RPOSBEZNETTO;
          end
         else
          begin
           RVZ10SUMSOLL = RVZ10SUMSOLL + RGNPOSSOLL;
           RVZ10SUMBEZ = RVZ10SUMBEZ + RGNPOS;
           RVZ10SUMBEZNETTO = RVZ10SUMBEZNETTO + RGNPOSNETTO;
          end
        end
       /* Speichern */
       SUSPEND;
      end
     /* G/N EigentÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Â ÃƒÂ¢Ã¢â€šÂ¬Ã¢â€žÂ¢ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â¼mer */ 
     if ((RGNPOSSOLL <> 0) or (RGNPOS <> 0) or (RGNPOSNETTO <> 0)) then
      begin
       /* VZ1 */
       if (ITMPKNR = 60100) then
        begin
         SVZ1BEZ = SKBEZ;
         RGNEIG_VZ1 = RGNEIG_VZ1 + RGNPOS;
         RGNEIGNETTO_VZ1 = RGNEIGNETTO_VZ1 + RGNPOSNETTO;
         RGNEIGSOLL_VZ1 = RGNEIGSOLL_VZ1 + RGNPOSSOLL; 
         RGNEIG_SUMVZ1 = RGNEIG_SUMVZ1 + RGNPOS;
         RGNEIGNETTO_SUMVZ1 = RGNEIGNETTO_SUMVZ1 + RGNPOSNETTO;
         RGNEIGSOLL_SUMVZ1 = RGNEIGSOLL_SUMVZ1 + RGNPOSSOLL;           
        end
       /* VZ2 */
       if (ITMPKNR = 60110) then
        begin
         SVZ2BEZ = SKBEZ;
         RGNEIG_VZ2 = RGNEIG_VZ2 + RGNPOS;
         RGNEIGNETTO_VZ2 = RGNEIGNETTO_VZ2 + RGNPOSNETTO;
         RGNEIGSOLL_VZ2 = RGNEIGSOLL_VZ2 + RGNPOSSOLL;
         RGNEIG_SUMVZ2 = RGNEIG_SUMVZ2 + RGNPOS;
         RGNEIGNETTO_SUMVZ2 = RGNEIGNETTO_SUMVZ2 + RGNPOSNETTO;
         RGNEIGSOLL_SUMVZ2 = RGNEIGSOLL_SUMVZ2 + RGNPOSSOLL;          
        end
       /* VZ3 */
       if (ITMPKNR = 60120) then
        begin
         SVZ3BEZ = SKBEZ;
         RGNEIG_VZ3 = RGNEIG_VZ3 + RGNPOS;
         RGNEIGNETTO_VZ3 = RGNEIGNETTO_VZ3 + RGNPOSNETTO;
         RGNEIGSOLL_VZ3 = RGNEIGSOLL_VZ3 + RGNPOSSOLL;
         RGNEIG_SUMVZ3 = RGNEIG_SUMVZ3 + RGNPOS;
         RGNEIGNETTO_SUMVZ3 = RGNEIGNETTO_SUMVZ3 + RGNPOSNETTO;
         RGNEIGSOLL_SUMVZ3 = RGNEIGSOLL_SUMVZ3 + RGNPOSSOLL;                   
        end
       /* VZ4 */
       if (ITMPKNR = 60130) then
        begin
         SVZ4BEZ = SKBEZ;        
         RGNEIG_VZ4 = RGNEIG_VZ4 + RGNPOS;
         RGNEIGNETTO_VZ4 = RGNEIGNETTO_VZ4 + RGNPOSNETTO;
         RGNEIGSOLL_VZ4 = RGNEIGSOLL_VZ4 + RGNPOSSOLL;
         RGNEIG_SUMVZ4 = RGNEIG_SUMVZ4 + RGNPOS;
         RGNEIGNETTO_SUMVZ4 = RGNEIGNETTO_SUMVZ4 + RGNPOSNETTO;
         RGNEIGSOLL_SUMVZ4 = RGNEIGSOLL_SUMVZ4 + RGNPOSSOLL;                   
        end
       /* VZ5 */
       if (ITMPKNR = 60140) then
        begin
         SVZ5BEZ = SKBEZ;        
         RGNEIG_VZ5 = RGNEIG_VZ5 + RGNPOS;
         RGNEIGNETTO_VZ5 = RGNEIGNETTO_VZ5 + RGNPOSNETTO;
         RGNEIGSOLL_VZ5 = RGNEIGSOLL_VZ5 + RGNPOSSOLL; 
         RGNEIG_SUMVZ5 = RGNEIG_SUMVZ5 + RGNPOS;
         RGNEIGNETTO_SUMVZ5 = RGNEIGNETTO_SUMVZ5 + RGNPOSNETTO;
         RGNEIGSOLL_SUMVZ5 = RGNEIGSOLL_SUMVZ5 + RGNPOSSOLL;                  
        end
       /* VZ6 */
       if (ITMPKNR = 60150) then
        begin
         SVZ6BEZ = SKBEZ;        
         RGNEIG_VZ6 = RGNEIG_VZ6 + RGNPOS;
         RGNEIGNETTO_VZ6 = RGNEIGNETTO_VZ6 + RGNPOSNETTO;
         RGNEIGSOLL_VZ6 = RGNEIGSOLL_VZ6 + RGNPOSSOLL;
         RGNEIG_SUMVZ6 = RGNEIG_SUMVZ6 + RGNPOS;
         RGNEIGNETTO_SUMVZ6 = RGNEIGNETTO_SUMVZ6 + RGNPOSNETTO;
         RGNEIGSOLL_SUMVZ6 = RGNEIGSOLL_SUMVZ6 + RGNPOSSOLL;          
        end
       /* VZ7 */
       if (ITMPKNR = 60160) then
        begin
         SVZ7BEZ = SKBEZ;        
         RGNEIG_VZ7 = RGNEIG_VZ7 + RGNPOS;
         RGNEIGNETTO_VZ7 = RGNEIGNETTO_VZ7 + RGNPOSNETTO;
         RGNEIGSOLL_VZ7 = RGNEIGSOLL_VZ7 + RGNPOSSOLL;
         RGNEIG_SUMVZ7 = RGNEIG_SUMVZ7 + RGNPOS;
         RGNEIGNETTO_SUMVZ7 = RGNEIGNETTO_SUMVZ7 + RGNPOSNETTO;
         RGNEIGSOLL_SUMVZ7 = RGNEIGSOLL_SUMVZ7 + RGNPOSSOLL;                   
        end
       /* VZ8 */
       if (ITMPKNR = 60170) then
        begin
         SVZ8BEZ = SKBEZ;        
         RGNEIG_VZ8 = RGNEIG_VZ8 + RGNPOS;
         RGNEIGNETTO_VZ8 = RGNEIGNETTO_VZ8 + RGNPOSNETTO;
         RGNEIGSOLL_VZ8 = RGNEIGSOLL_VZ8 + RGNPOSSOLL;
         RGNEIG_SUMVZ8 = RGNEIG_SUMVZ8 + RGNPOS;
         RGNEIGNETTO_SUMVZ8 = RGNEIGNETTO_SUMVZ8 + RGNPOSNETTO;
         RGNEIGSOLL_SUMVZ8 = RGNEIGSOLL_SUMVZ8 + RGNPOSSOLL;                   
        end       
      end       
    END    
   /* */ 
   if ((RGNEIG <> 0) or (RGNEIGNETTO <> 0) or (RGNEIGSOLL <> 0)) then
    begin
     if ((RGNEIG_VZ1 <> 0) or (RGNEIGNETTO_VZ1 <> 0) or (RGNEIGSOLL_VZ1 <> 0)) then
      begin
       SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ1BEZ || ')'; RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0;
       RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0; RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0;
       RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0; RGBEZNETTO4 = 0; RPOSSOLL = RGNEIGSOLL_VZ1;
       RPOSBEZ = RGNEIG_VZ1; RPOSBEZNETTO = RGNEIGNETTO_VZ1; SVZ10BEZ = 'Guthaben/Nachzahlungen (' || SVZ1BEZ || ')';
       BISNULL = 'N';
       ISMASTER = 0;
       VZKNR = 60190;
       SUSPEND;
      END 
     /* */
     if ((RGNEIG_VZ2 <> 0) or (RGNEIGNETTO_VZ2 <> 0) or (RGNEIGSOLL_VZ2 <> 0)) then
      begin
       SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ2BEZ || ')'; RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0;
       RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0; RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0;
       RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0; RGBEZNETTO4 = 0; RPOSSOLL = RGNEIGSOLL_VZ2;
       RPOSBEZ = RGNEIG_VZ2; RPOSBEZNETTO = RGNEIGNETTO_VZ2; SVZ10BEZ = 'Guthaben/Nachzahlungen (' || SVZ2BEZ || ')';
       BISNULL = 'N';
       ISMASTER = 0;
       VZKNR = 60191;
       SUSPEND;
      END
     /* */
     if ((RGNEIG_VZ3 <> 0) or (RGNEIGNETTO_VZ3 <> 0) or (RGNEIGSOLL_VZ3 <> 0)) then
      begin
       SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ3BEZ || ')'; RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0;
       RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0; RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0;
       RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0; RGBEZNETTO4 = 0; RPOSSOLL = RGNEIGSOLL_VZ3;
       RPOSBEZ = RGNEIG_VZ3; RPOSBEZNETTO = RGNEIGNETTO_VZ3; SVZ10BEZ = 'Guthaben/Nachzahlungen (' || SVZ3BEZ || ')';
       BISNULL = 'N';
       ISMASTER = 0;
       VZKNR = 60192;
       SUSPEND;
      END 
     /* */
     if ((RGNEIG_VZ4 <> 0) or (RGNEIGNETTO_VZ4 <> 0) or (RGNEIGSOLL_VZ4 <> 0)) then
      begin
       SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ4BEZ || ')'; RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0;
       RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0; RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0;
       RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0; RGBEZNETTO4 = 0; RPOSSOLL = RGNEIGSOLL_VZ4;
       RPOSBEZ = RGNEIG_VZ4; RPOSBEZNETTO = RGNEIGNETTO_VZ4; SVZ10BEZ = 'Guthaben/Nachzahlungen (' || SVZ4BEZ || ')';
       BISNULL = 'N';
       ISMASTER = 0;
       VZKNR = 60193;
       SUSPEND;
      END
     /* */
     if ((RGNEIG_VZ5 <> 0) or (RGNEIGNETTO_VZ5 <> 0) or (RGNEIGSOLL_VZ5 <> 0)) then
      begin
       SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ5BEZ || ')'; RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0;
       RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0; RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0;
       RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0; RGBEZNETTO4 = 0; RPOSSOLL = RGNEIGSOLL_VZ5;
       RPOSBEZ = RGNEIG_VZ5; RPOSBEZNETTO = RGNEIGNETTO_VZ5; SVZ10BEZ = 'Guthaben/Nachzahlungen (' || SVZ5BEZ || ')';
       BISNULL = 'N';
       ISMASTER = 0;
       VZKNR = 60194;
       SUSPEND;
      END
     /* */
     if ((RGNEIG_VZ6 <> 0) or (RGNEIGNETTO_VZ6 <> 0) or (RGNEIGSOLL_VZ6 <> 0)) then
      begin
       SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ6BEZ || ')'; RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0;
       RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0; RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0;
       RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0; RGBEZNETTO4 = 0; RPOSSOLL = RGNEIGSOLL_VZ6;
       RPOSBEZ = RGNEIG_VZ6; RPOSBEZNETTO = RGNEIGNETTO_VZ6; SVZ10BEZ = 'Guthaben/Nachzahlungen (' || SVZ6BEZ || ')';
       BISNULL = 'N';
       ISMASTER = 0;
       VZKNR = 60195;
       SUSPEND;
      END
     /* */
     if ((RGNEIG_VZ7 <> 0) or (RGNEIGNETTO_VZ7 <> 0) or (RGNEIGSOLL_VZ7 <> 0)) then
      begin
       SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ7BEZ || ')'; RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0;
       RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0; RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0;
       RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0; RGBEZNETTO4 = 0; RPOSSOLL = RGNEIGSOLL_VZ7;
       RPOSBEZ = RGNEIG_VZ7; RPOSBEZNETTO = RGNEIGNETTO_VZ7; SVZ10BEZ = 'Guthaben/Nachzahlungen (' || SVZ7BEZ || ')';
       BISNULL = 'N';
       ISMASTER = 0;
       VZKNR = 60196;
       SUSPEND;
      END   
     /* */
     if ((RGNEIG_VZ8 <> 0) or (RGNEIGNETTO_VZ8 <> 0) or (RGNEIGSOLL_VZ8 <> 0)) then
      begin
       SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ8BEZ || ')'; RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0;
       RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0; RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0;
       RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0; RGBEZNETTO4 = 0; RPOSSOLL = RGNEIGSOLL_VZ8;
       RPOSBEZ = RGNEIG_VZ8; RPOSBEZNETTO = RGNEIGNETTO_VZ8; SVZ10BEZ = 'Guthaben/Nachzahlungen (' || SVZ8BEZ || ')';
       BISNULL = 'N';
       ISMASTER = 0;
       VZKNR = 60197;
       SUSPEND;
      END                  
    end    
   /* Master einfÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã¢â‚¬Â ÃƒÂ¢Ã¢â€šÂ¬Ã¢â€žÂ¢ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â¼gen */
   SKBEZ = SNAME;
   RVORTRAG = RTVORTRAG;
   RGSOLL1 = RTGSOLL1;
   RGBEZ1 = RTGBEZ1;
   RGBEZNETTO1 = RTGBEZNETTO1;
   RGSOLL2 = RTGSOLL2;
   RGBEZ2 = RTGBEZ2;
   RGBEZNETTO2 = RTGBEZNETTO2;
   RGSOLL3 = RTGSOLL3;
   RGBEZ3 = RTGBEZ3;
   RGBEZNETTO3 = RTGBEZNETTO3;
   RGSOLL4 = RTGSOLL4;
   RGBEZ4 = RTGBEZ4;
   RGBEZNETTO4 = RTGBEZNETTO4;
   RPOSSOLL = 0;
   RPOSBEZ = 0;
   RPOSBEZNETTO = 0;
   /* FUER SUMME */
   RSUMVORTRAG = RSUMVORTRAG + RTVORTRAG;
   RSUMGSOLL1 = RSUMGSOLL1 + RTGSOLL1;
   RSUMGBEZ1 = RSUMGBEZ1 + RTGBEZ1;
   RSUMGBEZNETTO1 = RSUMGBEZNETTO1 + RTGBEZNETTO1;
   RSUMGSOLL2 = RSUMGSOLL2 + RTGSOLL2;
   RSUMGBEZ2 = RSUMGBEZ2 + RTGBEZ2;
   RSUMGBEZNETTO2 = RSUMGBEZNETTO2 + RTGBEZNETTO2;
   RSUMGSOLL3 = RSUMGSOLL3 + RTGSOLL3;
   RSUMGBEZ3 = RSUMGBEZ3 + RTGBEZ3;
   RSUMGBEZNETTO3 = RSUMGBEZNETTO3 + RSUMGBEZNETTO3;
   RSUMGSOLL4 = RSUMGSOLL4 + RTGSOLL4;
   RSUMGBEZ4 = RSUMGBEZ4 + RTGBEZ4;
   RSUMGBEZNETTO4 = RSUMGBEZNETTO4 + RTGBEZNETTO4;
   /* Wenn alles 0 */
   if ((RGSOLL1 = 0) and (RGBEZ1 = 0) and (RGSOLL2 = 0) and (RGBEZ2 = 0) and (RGSOLL3 = 0) and (RGBEZ3 = 0) and (RGSOLL4 = 0) and (RGBEZ4 = 0)) then
    BISNULL = 'J';
   else
    BISNULL = 'N';
   /* MASTER */
   ISMASTER = 1;
   VZKNR = 0;
   /* GESCHOSS + MIETEINNAHME_ART */
   if (:KNR >= 200000) then
    begin
     GESCHOSS = -1;
     MIETEINNAHME_ART = -1;
    end
   else
    begin
     select geschoss, mieteinnahme_art from bewohner where onr=:ionr and knr=:knr into :GESCHOSS, :MIETEINNAHME_ART;
    end
   /* EINTRAG */
   SUSPEND;
  END /* Select Konten */
 /* Summen */
 ISMASTER = 1;
 KNR = 999999;
 KNRSTR = '';
 SKBEZ = 'SUMME HAUS:';
 RVORTRAG = RSUMVORTRAG;
 RGSOLL1 = RSUMGSOLL1;
 RGBEZ1 = RSUMGBEZ1;
 RGBEZNETTO1 = RSUMGBEZNETTO1;
 RGSOLL2 = RSUMGSOLL2;
 RGBEZ2 = RSUMGBEZ2;
 RGBEZNETTO2 = RSUMGBEZNETTO2;
 RGSOLL3 = RSUMGSOLL3;
 RGBEZ3 = RSUMGBEZ3;
 RGBEZNETTO3 = RSUMGBEZNETTO3;
 RGSOLL4 = RSUMGSOLL4;
 RGBEZ4 = RSUMGBEZ4;
 RGBEZNETTO4 = RSUMGBEZNETTO4;
 RPOSSOLL = 0;
 RPOSBEZ = 0;
 RPOSBEZNETTO = 0;
 BISNULL='N';
 VZKNR = 0;
 SUSPEND;
 /* VZ Position 1 */
 if ((RVZ1SUMSOLL <> 0) or (RVZ1SUMBEZ <> 0) or (RVZ1SUMBEZNETTO <> 0)) then
  begin
   KNR = 999999;
   KNRSTR = '';
   SKBEZ = SVZ1BEZ;
   RVORTRAG = 0;
   RGSOLL1 = 0;
   RGBEZ1 = 0;
   RGBEZNETTO1 = 0;
   RGSOLL2 = 0;
   RGBEZ2 = 0;
   RGBEZNETTO2 = 0;
   RGSOLL3 = 0;
   RGBEZ3 = 0;
   RGBEZNETTO3 = 0;
   RGSOLL4 = 0;
   RGBEZ4 = 0;
   RGBEZNETTO4 = 0;
   RPOSSOLL = RVZ1SUMSOLL;
   RPOSBEZ = RVZ1SUMBEZ;
   RPOSBEZNETTO = RVZ1SUMBEZNETTO;
   BISNULL = 'N';
   ISMASTER = 0;
   VZKNR = 1;
   SUSPEND;
  end
 /* VZ Position 2 */
 if ((RVZ2SUMSOLL <> 0) or (RVZ2SUMBEZ <> 0) or (RVZ2SUMBEZNETTO <> 0)) then
  begin
   KNR = 999999;
   KNRSTR = '';
   SKBEZ = SVZ2BEZ;
   RVORTRAG = 0;
   RGSOLL1 = 0;
   RGBEZ1 = 0;
   RGBEZNETTO1 = 0;
   RGSOLL2 = 0;
   RGBEZ2 = 0;
   RGBEZNETTO2 = 0;
   RGSOLL3 = 0;
   RGBEZ3 = 0;
   RGBEZNETTO3 = 0;
   RGSOLL4 = 0;
   RGBEZ4 = 0;
   RGBEZNETTO4 = 0;
   RPOSSOLL = RVZ2SUMSOLL;
   RPOSBEZ = RVZ2SUMBEZ;
   RPOSBEZNETTO = RVZ2SUMBEZNETTO;
   BISNULL = 'N';
   ISMASTER = 0;
   VZKNR = 2;
   SUSPEND;
  end
 /* VZ Position 3 */
 if ((RVZ3SUMSOLL <> 0) or (RVZ3SUMBEZ <> 0) or (RVZ3SUMBEZNETTO <> 0)) then
  begin
   KNR = 999999;
   KNRSTR = '';
   SKBEZ = SVZ3BEZ;
   RVORTRAG = 0;
   RGSOLL1 = 0;
   RGBEZ1 = 0;
   RGBEZNETTO1 = 0;
   RGSOLL2 = 0;
   RGBEZ2 = 0;
   RGBEZNETTO2 = 0;
   RGSOLL3 = 0;
   RGBEZ3 = 0;
   RGBEZNETTO3 = 0;
   RGSOLL4 = 0;
   RGBEZ4 = 0;
   RGBEZNETTO4 = 0;
   RPOSSOLL = RVZ3SUMSOLL;
   RPOSBEZ = RVZ3SUMBEZ;
   RPOSBEZNETTO = RVZ3SUMBEZNETTO;
   BISNULL = 'N';
   ISMASTER = 0;
   VZKNR = 3;
   SUSPEND;
  end
 /* VZ Position 4 */
 if ((RVZ4SUMSOLL <> 0) or (RVZ4SUMBEZ <> 0) or (RVZ4SUMBEZNETTO <> 0)) then
  begin
   KNR = 999999;
   KNRSTR = '';
   SKBEZ = SVZ4BEZ;
   RVORTRAG = 0;
   RGSOLL1 = 0;
   RGBEZ1 = 0;
   RGBEZNETTO1 = 0;
   RGSOLL2 = 0;
   RGBEZ2 = 0;
   RGBEZNETTO2 = 0;
   RGSOLL3 = 0;
   RGBEZ3 = 0;
   RGBEZNETTO3 = 0;
   RGSOLL4 = 0;
   RGBEZ4 = 0;
   RGBEZNETTO4 = 0;
   RPOSSOLL = RVZ4SUMSOLL;
   RPOSBEZ = RVZ4SUMBEZ;
   RPOSBEZNETTO = RVZ4SUMBEZNETTO;
   BISNULL = 'N';
   ISMASTER = 0;
   VZKNR = 4;
   SUSPEND;
  end
 /* VZ Position 5 */
 if ((RVZ5SUMSOLL <> 0) or (RVZ5SUMBEZ <> 0) or (RVZ5SUMBEZNETTO <> 0)) then
  begin
   KNR = 999999;
   KNRSTR = '';
   SKBEZ = SVZ5BEZ;
   RVORTRAG = 0;
   RGSOLL1 = 0;
   RGBEZ1 = 0;
   RGBEZNETTO1 = 0;
   RGSOLL2 = 0;
   RGBEZ2 = 0;
   RGBEZNETTO2 = 0;
   RGSOLL3 = 0;
   RGBEZ3 = 0;
   RGBEZNETTO3 = 0;
   RGSOLL4 = 0;
   RGBEZ4 = 0;
   RGBEZNETTO4 = 0;
   RPOSSOLL = RVZ5SUMSOLL;
   RPOSBEZ = RVZ5SUMBEZ;
   RPOSBEZNETTO = RVZ5SUMBEZNETTO;
   BISNULL = 'N';
   ISMASTER = 0;
   VZKNR = 5;
   SUSPEND;
  end
 /* VZ Position 6 */
 if ((RVZ6SUMSOLL <> 0) or (RVZ6SUMBEZ <> 0) or (RVZ6SUMBEZNETTO <> 0)) then
  begin
   KNR = 999999;
   KNRSTR = '';
   SKBEZ = SVZ6BEZ;
   RVORTRAG = 0;
   RGSOLL1 = 0;
   RGBEZ1 = 0;
   RGBEZNETTO1 = 0;
   RGSOLL2 = 0;
   RGBEZ2 = 0;
   RGBEZNETTO2 = 0;
   RGSOLL3 = 0;
   RGBEZ3 = 0;
   RGBEZNETTO3 = 0;
   RGSOLL4 = 0;
   RGBEZ4 = 0;
   RGBEZNETTO4 = 0;
   RPOSSOLL = RVZ6SUMSOLL;
   RPOSBEZ = RVZ6SUMBEZ;
   RPOSBEZNETTO = RVZ6SUMBEZNETTO;
   BISNULL = 'N';
   ISMASTER = 0;
   VZKNR = 6;
   SUSPEND;
  end
 /* VZ Position 7 */
 if ((RVZ7SUMSOLL <> 0) or (RVZ7SUMBEZ <> 0) or (RVZ7SUMBEZNETTO <> 0)) then
  begin
   KNR = 999999;
   KNRSTR = '';
   SKBEZ = SVZ7BEZ;
   RVORTRAG = 0;
   RGSOLL1 = 0;
   RGBEZ1 = 0;
   RGBEZNETTO1 = 0;
   RGSOLL2 = 0;
   RGBEZ2 = 0;
   RGBEZNETTO2 = 0;
   RGSOLL3 = 0;
   RGBEZ3 = 0;
   RGBEZNETTO3 = 0;
   RGSOLL4 = 0;
   RGBEZ4 = 0;
   RGBEZNETTO4 = 0;
   RPOSSOLL = RVZ7SUMSOLL;
   RPOSBEZ = RVZ7SUMBEZ;
   RPOSBEZNETTO = RVZ7SUMBEZNETTO;
   BISNULL = 'N';
   ISMASTER = 0;
   VZKNR = 7;
   SUSPEND;
  end
 /* VZ Position 8 */
 if ((RVZ8SUMSOLL <> 0) or (RVZ8SUMBEZ <> 0) or (RVZ8SUMBEZNETTO <> 0)) then
  begin
   KNR = 999999;
   KNRSTR = '';
   SKBEZ = SVZ8BEZ;
   RVORTRAG = 0;
   RGSOLL1 = 0;
   RGBEZ1 = 0;
   RGBEZNETTO1 = 0;
   RGSOLL2 = 0;
   RGBEZ2 = 0;
   RGBEZNETTO2 = 0;
   RGSOLL3 = 0;
   RGBEZ3 = 0;
   RGBEZNETTO3 = 0;
   RGSOLL4 = 0;
   RGBEZ4 = 0;
   RGBEZNETTO4 = 0;
   RPOSSOLL = RVZ8SUMSOLL;
   RPOSBEZ = RVZ8SUMBEZ;
   RPOSBEZNETTO = RVZ8SUMBEZNETTO;
   BISNULL = 'N';
   ISMASTER = 0;
   VZKNR = 8;
   SUSPEND;
  end
 /* VZ Position 9 */
 if ((RVZ9SUMSOLL <> 0) or (RVZ9SUMBEZ <> 0) or (RVZ9SUMBEZNETTO <> 0)) then
  begin
   KNR = 999999;
   KNRSTR = '';
   SKBEZ = SVZ9BEZ;
   RVORTRAG = 0;
   RGSOLL1 = 0;
   RGBEZ1 = 0;
   RGBEZNETTO1 = 0;
   RGSOLL2 = 0;
   RGBEZ2 = 0;
   RGBEZNETTO2 = 0;
   RGSOLL3 = 0;
   RGBEZ3 = 0;
   RGBEZNETTO3 = 0;
   RGSOLL4 = 0;
   RGBEZ4 = 0;
   RGBEZNETTO4 = 0;
   RPOSSOLL = RVZ9SUMSOLL;
   RPOSBEZ = RVZ9SUMBEZ;
   RPOSBEZNETTO = RVZ9SUMBEZNETTO;
   BISNULL = 'N';
   ISMASTER = 0;
   VZKNR = 9;
   SUSPEND;
  end
 /* VZ Position 10 */
 if (BBEW = 'J') then
  begin
   if ((RVZ10SUMSOLL <> 0) or (RVZ10SUMBEZ <> 0) or (RVZ10SUMBEZNETTO <> 0)) then
    begin
     KNR = 999999;
     KNRSTR = '';
     SKBEZ = SVZ10BEZ;
     RVORTRAG = 0;
     RGSOLL1 = 0;
     RGBEZ1 = 0;
     RGBEZNETTO1 = 0;
     RGSOLL2 = 0;
     RGBEZ2 = 0;
     RGBEZNETTO2 = 0;
     RGSOLL3 = 0;
     RGBEZ3 = 0;
     RGBEZNETTO3 = 0;
     RGSOLL4 = 0;
     RGBEZ4 = 0;
     RGBEZNETTO4 = 0;
     RPOSSOLL = RVZ10SUMSOLL;
     RPOSBEZ = RVZ10SUMBEZ;
     RPOSBEZNETTO = RVZ10SUMBEZNETTO;
     BISNULL = 'N';
     ISMASTER = 0;
     VZKNR = 10;
     SUSPEND;
    end
  end
 else
  begin
   if ((RGNEIGSOLL_SUMVZ1 <> 0) or (RGNEIG_SUMVZ1 <> 0) or (RGNEIGNETTO_SUMVZ1 <> 0)) then
    begin
     KNR = 999999;
     KNRSTR = '';
     SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ1BEZ || ')';
     RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0; RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0;
     RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0; RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0;
     RGBEZNETTO4 = 0;
     RPOSSOLL = RGNEIGSOLL_SUMVZ1;
     RPOSBEZ = RGNEIG_SUMVZ1;
     RPOSBEZNETTO = RGNEIGNETTO_SUMVZ1;
     BISNULL = 'N';
     ISMASTER = 0;
     VZKNR = 10;
     SUSPEND;
    end 
   /* */
   if ((RGNEIGSOLL_SUMVZ2 <> 0) or (RGNEIG_SUMVZ2 <> 0) or (RGNEIGNETTO_SUMVZ2 <> 0)) then
    begin
     KNR = 999999;
     KNRSTR = '';
     SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ2BEZ || ')';
     RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0; RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0;
     RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0; RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0;
     RGBEZNETTO4 = 0;
     RPOSSOLL = RGNEIGSOLL_SUMVZ2;
     RPOSBEZ = RGNEIG_SUMVZ2;
     RPOSBEZNETTO = RGNEIGNETTO_SUMVZ2;
     BISNULL = 'N';
     ISMASTER = 0;
     VZKNR = 11;
     SUSPEND;
    end  
   /* */
   if ((RGNEIGSOLL_SUMVZ3 <> 0) or (RGNEIG_SUMVZ3 <> 0) or (RGNEIGNETTO_SUMVZ3 <> 0)) then
    begin
     KNR = 999999;
     KNRSTR = '';
     SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ3BEZ || ')';
     RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0; RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0;
     RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0; RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0;
     RGBEZNETTO4 = 0;
     RPOSSOLL = RGNEIGSOLL_SUMVZ3;
     RPOSBEZ = RGNEIG_SUMVZ3;
     RPOSBEZNETTO = RGNEIGNETTO_SUMVZ3;
     BISNULL = 'N';
     ISMASTER = 0;
     VZKNR = 12;
     SUSPEND;
    end
   /* */
   if ((RGNEIGSOLL_SUMVZ4 <> 0) or (RGNEIG_SUMVZ4 <> 0) or (RGNEIGNETTO_SUMVZ4 <> 0)) then
    begin
     KNR = 999999;
     KNRSTR = '';
     SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ4BEZ || ')';
     RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0; RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0;
     RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0; RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0;
     RGBEZNETTO4 = 0;
     RPOSSOLL = RGNEIGSOLL_SUMVZ4;
     RPOSBEZ = RGNEIG_SUMVZ4;
     RPOSBEZNETTO = RGNEIGNETTO_SUMVZ4;
     BISNULL = 'N';
     ISMASTER = 0;
     VZKNR = 13;
     SUSPEND;
    end 
   /* */
   if ((RGNEIGSOLL_SUMVZ5 <> 0) or (RGNEIG_SUMVZ5 <> 0) or (RGNEIGNETTO_SUMVZ5 <> 0)) then
    begin
     KNR = 999999;
     KNRSTR = '';
     SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ5BEZ || ')';
     RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0; RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0;
     RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0; RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0;
     RGBEZNETTO4 = 0;
     RPOSSOLL = RGNEIGSOLL_SUMVZ5;
     RPOSBEZ = RGNEIG_SUMVZ5;
     RPOSBEZNETTO = RGNEIGNETTO_SUMVZ5;
     BISNULL = 'N';
     ISMASTER = 0;
     VZKNR = 14;
     SUSPEND;
    end
   /* */
   if ((RGNEIGSOLL_SUMVZ6 <> 0) or (RGNEIG_SUMVZ6 <> 0) or (RGNEIGNETTO_SUMVZ6 <> 0)) then
    begin
     KNR = 999999;
     KNRSTR = '';
     SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ6BEZ || ')';
     RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0; RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0;
     RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0; RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0;
     RGBEZNETTO4 = 0;
     RPOSSOLL = RGNEIGSOLL_SUMVZ6;
     RPOSBEZ = RGNEIG_SUMVZ6;
     RPOSBEZNETTO = RGNEIGNETTO_SUMVZ6;
     BISNULL = 'N';
     ISMASTER = 0;
     VZKNR = 15;
     SUSPEND;
    end
   /* */
   if ((RGNEIGSOLL_SUMVZ7 <> 0) or (RGNEIG_SUMVZ7 <> 0) or (RGNEIGNETTO_SUMVZ7 <> 0)) then
    begin
     KNR = 999999;
     KNRSTR = '';
     SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ7BEZ || ')';
     RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0; RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0;
     RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0; RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0;
     RGBEZNETTO4 = 0;
     RPOSSOLL = RGNEIGSOLL_SUMVZ7;
     RPOSBEZ = RGNEIG_SUMVZ7;
     RPOSBEZNETTO = RGNEIGNETTO_SUMVZ7;
     BISNULL = 'N';
     ISMASTER = 0;
     VZKNR = 16;
     SUSPEND;
    end
   /* */
   if ((RGNEIGSOLL_SUMVZ8 <> 0) or (RGNEIG_SUMVZ8 <> 0) or (RGNEIGNETTO_SUMVZ8 <> 0)) then
    begin
     KNR = 999999;
     KNRSTR = '';
     SKBEZ = 'Guthaben/Nachzahlungen (' || SVZ8BEZ || ')';
     RVORTRAG = 0; RGSOLL1 = 0; RGBEZ1 = 0; RGBEZNETTO1 = 0; RGSOLL2 = 0; RGBEZ2 = 0;
     RGBEZNETTO2 = 0; RGSOLL3 = 0; RGBEZ3 = 0; RGBEZNETTO3 = 0; RGSOLL4 = 0; RGBEZ4 = 0;
     RGBEZNETTO4 = 0;
     RPOSSOLL = RGNEIGSOLL_SUMVZ8;
     RPOSBEZ = RGNEIG_SUMVZ8;
     RPOSBEZNETTO = RGNEIGNETTO_SUMVZ8;
     BISNULL = 'N';
     ISMASTER = 0;
     VZKNR = 17;
     SUSPEND;
    end                       
  end   
END
