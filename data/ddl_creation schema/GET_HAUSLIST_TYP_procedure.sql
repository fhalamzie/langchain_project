-- Prozedur: GET_HAUSLIST_TYP
-- Generiert: 2025-05-31 10:26:41

CREATE OR ALTER PROCEDURE GET_HAUSLIST_TYP
DECLARE VARIABLE SARCHIV1 CHAR(1);
DECLARE VARIABLE SARCHIV2 CHAR(1);
BEGIN
 SARCHIV1 = 'J';
 SARCHIV2 = 'N';
 IF (IANZEIGEARCHIV = 1) THEN /* nicht archivierte */
  BEGIN
   SARCHIV1 = 'N';
   SARCHIV2 = 'N';
  END
 ELSE
  BEGIN
   IF (IANZEIGEARCHIV = 2) THEN /* nur archivierte */
    BEGIN
     SARCHIV1 = 'J';
     SARCHIV2 = 'J';
    END
  END   
 /* Abfrage */   
 IF (IVERWNR=-1) THEN
  BEGIN
   FOR
    SELECT ONR, OBEZ, OSTRASSE, OPLZORT FROM objekte where BSONST<>:INOTHAUSTYP and ONR>0 and ((ARCHIVIERT=:SARCHIV1) or (ARCHIVIERT=:SARCHIV2)) ORDER BY ONR
   INTO ONR, OBEZ, OSTRASSE, OPLZORT
   DO
    BEGIN
     SUSPEND;
    END
  END
 ELSE
  BEGIN
   FOR
    SELECT ONR, OBEZ, OSTRASSE, OPLZORT FROM objekte where BSONST<>:INOTHAUSTYP and ONR>0 and VERWNR=:IVERWNR and ((ARCHIVIERT=:SARCHIV1) or (ARCHIVIERT=:SARCHIV2)) ORDER BY ONR
   INTO ONR, OBEZ, OSTRASSE, OPLZORT
   DO
    BEGIN
     SUSPEND;
    END
  END
END
