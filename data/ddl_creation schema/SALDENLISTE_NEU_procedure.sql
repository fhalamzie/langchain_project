-- Prozedur: SALDENLISTE_NEU
-- Generiert: 2025-05-31 10:26:42

CREATE OR ALTER PROCEDURE SALDENLISTE_NEU
BEGIN

 /* TEMP 
 IONR=7;
 DTVON = '1.1.2018';
 DTBIS = '31.12.2018';
 VONKTO = 200200;
 BISKTO = 200200;
 WDATUM = 'N';
 BMITVORTRAG = 'J';
 BMITGN = 'J';
  TEMP    */
 
 IF (BNETTO='J') THEN
  BEGIN
   for select SUM(SUM_VZ_NETTO), SUM(SUM_VZ_NETTO_VORTRAG), 
            SUM(SUM_VZ_NETTO_SOLL), SUM(SUM_VZ_NETTO_VORTRAG_SOLL), 
            SUM(SUM_VZ_NETTO_VORTRAG_SOLL) - SUM(SUM_VZ_NETTO_VORTRAG),
            SUM(SUM_VZ_NETTO_SOLL) - SUM(SUM_VZ_NETTO),
            SUM(SUM_VZ_NETTO_VORTRAG_SOLL) - SUM(SUM_VZ_NETTO_VORTRAG) + SUM(SUM_VZ_NETTO_SOLL) - SUM(SUM_VZ_NETTO), 
            KNR, VZPOS, GN  
    from SALDENLISTE_NEU_DETAIL1(:IONR,:DTVON,:DTBIS,:VONKTO,:BISKTO,:WDATUM,:BMITVORTRAG,:BMITGN) 
    group by KNR, VZPOS, GN
    into SUM_VZ, SUM_VZ_VORTRAG, 
     SUM_VZ_SOLL, SUM_VZ_VORTRAG_SOLL,
     SUM_VZ_VORTRAG_SALDO, SUM_VZ_SALDO,SUM_VZ_SALDO_PLUS_VORTRAG,
     KNR, VZPOS, GN 
    DO
     begin
      SUSPEND;
     end 
   END
 ELSE
  BEGIN  
   for select SUM(SUM_VZ), SUM(SUM_VZ_VORTRAG),  
            SUM(SUM_VZ_SOLL), SUM(SUM_VZ_VORTRAG_SOLL),  
            SUM(SUM_VZ_VORTRAG_SOLL) - SUM(SUM_VZ_VORTRAG),
            SUM(SUM_VZ_SOLL) - SUM(SUM_VZ),
            SUM(SUM_VZ_VORTRAG_SOLL) - SUM(SUM_VZ_VORTRAG) + SUM(SUM_VZ_SOLL) - SUM(SUM_VZ), 
            KNR, VZPOS, GN  
    from SALDENLISTE_NEU_DETAIL1(:IONR,:DTVON,:DTBIS,:VONKTO,:BISKTO,:WDATUM,:BMITVORTRAG,:BMITGN) 
    group by KNR, VZPOS, GN
    into SUM_VZ, SUM_VZ_VORTRAG,  
     SUM_VZ_SOLL, SUM_VZ_VORTRAG_SOLL, 
     SUM_VZ_VORTRAG_SALDO, SUM_VZ_SALDO,SUM_VZ_SALDO_PLUS_VORTRAG,
     KNR, VZPOS, GN 
    DO   
     begin
      SUSPEND;
     end 
 END    
END
